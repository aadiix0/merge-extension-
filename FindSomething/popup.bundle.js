(()=>{var e={815:function(e,t){var n,s;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,n=function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class s extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const r=(t,n)=>(...s)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||s.length<=1&&!1!==n.singleCallbackArg?t.resolve(s[0]):t.resolve(s)},a=e=>1==e?"argument":"arguments",o=(e,t,n)=>new Proxy(t,{apply:(t,s,r)=>n.call(s,e,...r)});let i=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},n={})=>{let s=Object.create(null),c={has:(t,n)=>n in e||n in s,get(c,m,g){if(m in s)return s[m];if(!(m in e))return;let p=e[m];if("function"==typeof p)if("function"==typeof t[m])p=o(e,e[m],t[m]);else if(i(n,m)){let t=((e,t)=>function(n,...s){if(s.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${s.length}`);if(s.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${s.length}`);return new Promise((a,o)=>{if(t.fallbackToNoCallback)try{n[e](...s,r({resolve:a,reject:o},t))}catch(r){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,r),n[e](...s),t.fallbackToNoCallback=!1,t.noCallback=!0,a()}else t.noCallback?(n[e](...s),a()):n[e](...s,r({resolve:a,reject:o},t))})})(m,n[m]);p=o(e,e[m],t)}else p=p.bind(e);else if("object"==typeof p&&null!==p&&(i(t,m)||i(n,m)))p=l(p,t[m],n[m]);else{if(!i(n,"*"))return Object.defineProperty(s,m,{configurable:!0,enumerable:!0,get:()=>e[m],set(t){e[m]=t}}),p;p=l(p,t[m],n["*"])}return s[m]=p,p},set:(t,n,r,a)=>(n in s?s[n]=r:e[n]=r,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(s,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(s,t)},m=Object.create(e);return new Proxy(m,c)},c=e=>({addListener(t,n,...s){t.addListener(e.get(n),...s)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),m=new s(e=>"function"!=typeof e?e:function(t){const n=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)}),g=new s(e=>"function"!=typeof e?e:function(t,n,s){let r,a,o=!1,i=new Promise(e=>{r=function(t){o=!0,e(t)}});try{a=e(t,n,r)}catch(e){a=Promise.reject(e)}const l=!0!==a&&((c=a)&&"object"==typeof c&&"function"==typeof c.then);var c;if(!0!==a&&!l&&!o)return!1;return(l?a:i).then(e=>{s(e)},e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",s({__mozWebExtensionPolyfillReject__:!0,message:t})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)}),!0}),p=({reject:n,resolve:s},r)=>{e.runtime.lastError?e.runtime.lastError.message===t?s():n(new Error(e.runtime.lastError.message)):r&&r.__mozWebExtensionPolyfillReject__?n(new Error(r.message)):s(r)},d=(e,t,n,...s)=>{if(s.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${s.length}`);if(s.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${s.length}`);return new Promise((e,t)=>{const r=p.bind(null,{resolve:e,reject:t});s.push(r),n.sendMessage(...s)})},u={devtools:{network:{onRequestFinished:c(m)}},runtime:{onMessage:c(g),onMessageExternal:c(g),sendMessage:d.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:d.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},h={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":h},services:{"*":h},websites:{"*":h}},l(e,u,n)};e.exports=n(chrome)}},void 0===(s=n.apply(t,[e]))||(e.exports=s)}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(815),t=n.n(e);if("undefined"!=typeof console)try{console.log=()=>{},console.warn=()=>{}}catch(e){}const s={isUpdating:!1,lastUpdateTime:0,pendingUpdate:null,updateInterval:1e3};function r(){s.isUpdating=!0,s.lastUpdateTime=Date.now()}function a(){s.isUpdating=!1}const o=new class{constructor(){this.batchSize=100,this.collapsedCount=0,this.totalElements=0,this.renderStartTime=0,this.virtualScrollThreshold=100,this.setupGlobalEventDelegation()}setupGlobalEventDelegation(){document.addEventListener("contextmenu",e=>{const n=e.target.closest("span");n&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{try{const e=o.getCopyableTextFromSpan(n);if(e&&"🈚️"!==e){!function(){try{document.querySelectorAll(".copy-success-tooltip").forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)});const e=document.createElement("div");e.className="copy-success-tooltip",e.textContent=t().i18n.getMessage("popupCopySuccess")||"复制成功",e.style.background="#4CAF50",document.body.appendChild(e),requestAnimationFrame(()=>{e.style.opacity="1"}),setTimeout(()=>{e.style.opacity="0",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},200)},1200)}catch(e){}}(),u(e);try{E(t().i18n.getMessage("popupCopySuccess")||"复制成功","success",1500)}catch(e){}}}catch(e){}},0))}),document.addEventListener("click",e=>{let t=e.target;if("SPAN"!==t.tagName&&(t=e.target.closest("span.collapsible")),!t||!t.classList.contains("collapsible"))return;if(e.target.classList.contains("expand-hint")||e.target.classList.contains("collapse-hint"))return;if(e.stopPropagation(),e.preventDefault(),t.classList.contains("expanded")){t.classList.remove("expanded"),t.classList.add("collapsed");const e=t.closest(".virtual-scroll-item");e&&e.style.setProperty("--vs-divider-color","transparent")}else{t.classList.remove("collapsed"),t.classList.add("expanded");const e=t.closest(".virtual-scroll-item");e&&e.style.setProperty("--vs-divider-color","rgba(0,0,0,0.06)")}const n=t.querySelector(".expand-hint"),s=t.querySelector(".collapse-hint");n&&s&&(t.classList.contains("expanded")?(n.style.display="none",s.style.display="inline"):(n.style.display="inline",s.style.display="none"))})}checkBatchLineCounts(e){const t=e.filter(({span:e})=>e&&"true"!==e.dataset.collapsibleSetup);0!==t.length&&(window.requestIdleCallback?requestIdleCallback(()=>{this.processCollapsibleElements(t)},{timeout:1e3}):setTimeout(()=>{this.processCollapsibleElements(t)},0))}processCollapsibleElements(e){e.forEach(({span:e,toggleBtn:n})=>{if(!e||"true"===e.dataset.collapsibleSetup)return;const s=e.textContent||"";if(!s.trim()||s.length<40)return void(e.dataset.collapsibleSetup="true");let r=!1;if(s.length>=200?r=!0:(r=(s.match(/\n/g)||[]).length+1>2,!r&&s.length>100&&(r=Math.ceil(s.length/50)>2)),r){e.classList.add("collapsible","collapsed");const n=t().i18n.getMessage("popupClickToExpand")||"点击展开",s=t().i18n.getMessage("popupClickToCollapse")||"点击收起",r=document.createElement("span");r.className="expand-hint",r.textContent=` ▼ [${n}]`;const a=document.createElement("span");a.className="collapse-hint",a.textContent=` ▲ [${s}]`,a.style.display="none",e.appendChild(r),e.appendChild(a),this.collapsedCount++}e.dataset.collapsibleSetup="true"})}renderBatchToContainer(e,t,n){if(!e||!t||0===t.length)return;if(t.length>this.virtualScrollThreshold&&i.enableVirtualScroll(e,t,n))return;this.renderStartTime=performance.now(),e.innerHTML="",e.style.whiteSpace="pre";const s=document.createDocumentFragment(),r=[];t.forEach((e,t)=>{try{const a=n(e,t);a&&a.forEach(e=>{if(s.appendChild(e),"SPAN"===e.tagName)r.push({span:e,toggleBtn:null});else if("DIV"===e.tagName&&("info-item"===e.className||"showcode-item"===e.className)){const t=e.querySelector("span");t&&r.push({span:t,toggleBtn:null})}}),this.totalElements++}catch(e){}}),e.appendChild(s),this.checkBatchLineCounts(r),performance.now(),this.renderStartTime}getCopyableTextFromSpan(e){try{const t=e.cloneNode(!0);return t.querySelectorAll(".expand-hint, .collapse-hint").forEach(e=>e.remove()),t.textContent.trim()}catch{return e.textContent.trim()}}},i=new class{constructor(){this.virtualScrollContainers=new Map,this.lineHeight=22,this.maxLines=2,this.itemVerticalPadding=4,this.itemHeight=this.lineHeight*this.maxLines+this.itemVerticalPadding,this.visibleCount=70,this.bufferCount=10}snapToDevicePixel(e){const t=window.devicePixelRatio||1;return Math.round(e*t)/t}computeLayoutForData(e,t){const n=t.clientWidth||400,s=Math.max(100,n-24),r=document.createElement("span");r.style.visibility="hidden",r.style.position="absolute",r.style.zIndex="-1",r.style.whiteSpace="pre-wrap",r.style.wordBreak="break-all",r.style.fontSize="14px",r.style.lineHeight=`${this.lineHeight}px`,r.style.width=`${s}px`,document.body.appendChild(r);const a=new Array(e.length),o=new Array(e.length),i=new Array(e.length);let l=0;for(let t=0;t<e.length;t++){const n="string"==typeof e[t]?e[t]:String(e[t]??"");let s;if(n.length<=40&&!/\n/.test(n))s=this.lineHeight;else{r.textContent=n;const e=r.scrollHeight||this.lineHeight,t=Math.max(1,Math.ceil(e/this.lineHeight));s=Math.min(t,this.maxLines)*this.lineHeight}const c=Math.round(s+this.itemVerticalPadding);o[t]=c,a[t]=c,i[t]=l,l+=c}return document.body.removeChild(r),{heights:a,tops:i,totalHeight:l,collapsedHeights:o}}enableVirtualScroll(e,t,n){if(!e||!t||this.virtualScrollContainers.has(e))return!1;const s=Math.min(this.visibleCount*this.itemHeight,2e3),r=document.createElement("div");r.className="virtual-scroll-container",r.style.height=`${this.snapToDevicePixel(s)}px`;const a=document.createElement("div");a.className="virtual-scroll-content",e.innerHTML="",e.appendChild(r),r.appendChild(a);const o=this.computeLayoutForData(t,r);return a.style.height=`${this.snapToDevicePixel(o.totalHeight)}px`,this.virtualScrollContainers.set(e,{data:t,createElementFunction:n,virtualContainer:r,contentContainer:a,totalHeight:o.totalHeight,itemHeight:this.itemHeight,visibleCount:this.visibleCount,bufferCount:this.bufferCount,renderedItems:new Set,totalItems:t.length,heights:o.heights,tops:o.tops,collapsedHeights:o.collapsedHeights}),r.addEventListener("scroll",t=>{const n=this.virtualScrollContainers.get(e);if(!n)return;const s=performance.now(),a=Math.abs(r.scrollTop-(n.lastScrollTop||0)),o=Math.max(1,s-(n.lastScrollTime||s));n.scrollSpeedPxPerMs=a/o,n.lastScrollTop=r.scrollTop,n.lastScrollTime=s,n.rafId||(n.rafId=requestAnimationFrame(()=>{n.rafId=null,this.renderVisibleItems(e)}))}),r.addEventListener("click",t=>{const n=t.target.closest(".virtual-scroll-item"),s=t.target.closest("span.collapsible");if(!n||!s)return;const r=parseInt(n.dataset.index);setTimeout(()=>this.remeasureItem(e,r),0)}),this.renderVisibleItems(e),!0}renderInitialItems(e){const t=this.virtualScrollContainers.get(e);if(!t)return;const{contentContainer:n,data:s,createElementFunction:r,itemHeight:a,visibleCount:o}=t,i=Math.min(o+2*t.bufferCount,s.length),l=document.createDocumentFragment();for(let e=0;e<i;e++){const n=this.createVirtualScrollItem(s[e],e,r,a);l.appendChild(n),t.renderedItems.add(e)}n.appendChild(l),this.updateScrollbarStyle(t.virtualContainer,s.length)}handleScroll(e,t){const n=this.virtualScrollContainers.get(e);n&&(n.scrollTimeout&&clearTimeout(n.scrollTimeout),n.scrollTimeout=setTimeout(()=>{this.renderVisibleItems(e)},16))}renderVisibleItems(e){const t=this.virtualScrollContainers.get(e);if(!t)return;const{virtualContainer:n,contentContainer:s,data:r,createElementFunction:a,itemHeight:o,visibleCount:i,bufferCount:l,tops:c,heights:m}=t;s.classList.add("vs-rendering");const g=n.scrollTop,p=t.cachedHeight||(t.cachedHeight=n.clientHeight||t.visibleCount*t.itemHeight),d=(e,t)=>{let n=0,s=e.length;for(;n<s;){const r=n+s>>>1;e[r]<t?n=r+1:s=r}return n},u=g+p,h=t.scrollSpeedPxPerMs||0,A=Math.min(50,l+Math.ceil(50*h)),f=Math.max(0,d(c,g)-A),x=Math.min(r.length,d(c,u)+A),y=i+2*A;let C=0;s.querySelectorAll(".virtual-scroll-item").forEach(e=>{const n=parseInt(e.dataset.index);if((n<f||n>=x)&&(e.parentNode&&e.parentNode.removeChild(e),t.renderedItems.delete(n),(!e.querySelector||!e.querySelector("span.collapsible.expanded"))&&t.collapsedHeights&&t.heights)){const e=t.collapsedHeights[n];if(e&&t.heights[n]!==e){const s=e-t.heights[n];t.heights[n]=e;for(let e=n+1;e<t.tops.length;e++)t.tops[e]+=s;t.totalHeight+=s,t.contentContainer.style.height=`${t.totalHeight}px`}}});const b=document.createDocumentFragment();for(let e=f;e<x&&C<y;e++)if(!t.renderedItems.has(e)){const n=this.createVirtualScrollItem(r[e],e,a,o);n.style.top=`${this.snapToDevicePixel(c[e])}px`,b.appendChild(n),t.renderedItems.add(e),C++}b.children.length>0&&s.appendChild(b);const v=s.lastElementChild;if(v&&v.offsetTop+v.offsetHeight<g+p+5){let e=x;const n=document.createDocumentFragment();for(;e<r.length&&C<y+A;){const s=this.createVirtualScrollItem(r[e],e,a,o);if(s.style.top=`${this.snapToDevicePixel(c[e])}px`,n.appendChild(s),t.renderedItems.add(e),C++,e++,c[e]>g+p+c[Math.max(0,f)]-c[f])break}n.children.length>0&&s.appendChild(n)}requestAnimationFrame(()=>s.classList.remove("vs-rendering"))}createVirtualScrollItem(e,t,n,s){const r=document.createElement("div");r.className="virtual-scroll-item",r.dataset.index=t,r.style.setProperty("--vs-divider-color","transparent");const a=n(e,t);return a&&a.forEach(e=>{if("DIV"!==e.tagName||"info-item"!==e.className&&"showcode-item"!==e.className)"SPAN"===e.tagName&&this.applyDynamicClamp(e);else{const t=e.querySelector("span");t&&this.applyDynamicClamp(t)}r.appendChild(e)}),r}applyDynamicClamp(e){try{const n=e.textContent||"";if(!n.trim())return;const s=document.createElement("span"),r=getComputedStyle(e);s.style.visibility="hidden",s.style.position="absolute",s.style.zIndex="-1",s.style.whiteSpace="pre-wrap",s.style.wordBreak=r.wordBreak||"break-all";const a=e.getBoundingClientRect().width||e.offsetWidth||e.clientWidth||400;s.style.width=`${a}px`,s.style.fontSize=r.fontSize||"14px";const o=Math.round(parseFloat(r.lineHeight))||this.lineHeight;s.style.lineHeight=`${o}px`,s.textContent=n,document.body.appendChild(s);const i=s.scrollHeight;document.body.removeChild(s);if(Math.max(1,Math.round(i/o))>this.maxLines){e.classList.add("collapsible","collapsed");const n=t().i18n.getMessage("popupClickToExpand")||"点击展开",s=t().i18n.getMessage("popupClickToCollapse")||"点击收起",r=l.getHintElement("expand-hint",` ▼ [${n}]`),a=l.getHintElement("collapse-hint",` ▲ [${s}]`);a.style.display="none",e.appendChild(r),e.appendChild(a)}else e.classList.remove("collapsible","collapsed","expanded")}catch(e){}}remeasureItem(e,t){const n=this.virtualScrollContainers.get(e);if(!n)return;const{data:s,virtualContainer:r,contentContainer:a,heights:o,tops:i}=n;if(t<0||t>=s.length)return;const l=a.querySelector(`.virtual-scroll-item[data-index="${t}"]`);if(!l)return;const c=l.getBoundingClientRect(),m=Math.max(this.snapToDevicePixel(c.height),this.lineHeight),g=o[t];if(!g||Math.abs(m-g)<.5)return;const p=m-g;o[t]=m;for(let e=t+1;e<i.length;e++)i[e]+=p;n.totalHeight+=p,n.contentContainer.style.height=`${n.totalHeight}px`,l.style.top=`${i[t]}px`,Array.from(n.contentContainer.querySelectorAll(".virtual-scroll-item")).forEach(e=>{const n=parseInt(e.dataset.index);n>t&&(e.style.top=`${this.snapToDevicePixel(i[n])}px`)}),this.renderVisibleItems(e)}updateScrollbarStyle(e,t){}disableVirtualScroll(e){const t=this.virtualScrollContainers.get(e);t&&(t.virtualContainer.remove(),this.virtualScrollContainers.delete(e))}getVirtualScrollStats(e){const t=this.virtualScrollContainers.get(e);return t?{totalItems:t.data?t.data.length:t.totalItems,renderedItems:t.renderedItems.size,visibleCount:t.visibleCount,bufferCount:t.bufferCount,container:e.id||e.className||"unknown"}:null}getTotalRenderedElements(){let e=0;return this.virtualScrollContainers.forEach((t,n)=>{e+=t.renderedItems.size}),e}logVirtualScrollStats(){let e=0,t=0;this.virtualScrollContainers.forEach((n,s)=>{const r=this.getVirtualScrollStats(s);r&&(e+=r.renderedItems,t+=r.totalItems)})}},l={hintElements:new Map,getHintElement(e,t){const n=`${e}_${t}`;if(this.hintElements.has(n)){const t=this.hintElements.get(n);return t.style.display="collapse-hint"===e?"none":"inline",t.cloneNode(!0)}const s=document.createElement("span");return s.className=e,s.textContent=t,this.hintElements.set(n,s),s.cloneNode(!0)},clear(){this.hintElements.clear()}};function c(e){document.getElementById(e).textContent=t().i18n.getMessage(e)}!function(){const e=["Zhuye","Peizhi","Shouce","popupIp","popupIpPort","popupDomain","popupSfz","popupMobile","popupMail","popupJwt","popupAlgorithm","popupSecret","popupPath","popupIncompletePath","popupUrl","popupStaticPath","popupAnalyze"];for(const t of e)try{c(t)}catch{}}(),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("manual-link");e&&e.addEventListener("click",function(e){e.preventDefault(),t().tabs.create({url:t().runtime.getURL("getstarted.html")})}),setTimeout(()=>{const e=document.querySelector("span.collapsible");e&&e.addEventListener("click",function(e){})},1e3)});var m=["ip","ip_port","domain","path","incomplete_path","url","static","sfz","mobile","mail","jwt","algorithm","secret"];function g(){var e=document.getElementsByClassName("copy");if(e)for(var n=0,s=0|e.length;n<s;n=n+1|0){e[n].textContent=t().i18n.getMessage("popupCopy");let s=e[n].name,r=e[n].id;"popupCopyurl"==r&&(e[n].textContent=t().i18n.getMessage("popupCopyurl")),e[n].onclick=function(e,n){return function(){p().then(async function(s){if(s&&s.url)try{const r=await t().storage.local.get(["findsomething_result_"+s.url]);if(!r||!r["findsomething_result_"+s.url])return;const a=r["findsomething_result_"+s.url];let o="",i="";if(i=e,i&&a[i]&&(Array.isArray(a[i])?o=a[i].join("\n"):"string"==typeof a[i]&&(o=a[i])),"popupCopyurl"==n)return void Promise.all([p().then(function(e){if(null!=e){var n=new URL(e.url),s=o.split("\n");o="";for(var r=0;r<s.length;r++)"."==s[r][0]?o+=n.origin+"/"+s[r]+"\n":o+=n.origin+s[r]+"\n";u(o.slice(0,-1))}else alert(t().i18n.getMessage("popupTipClickBeforeCopy"))})]).then(e=>{});u(o)}catch(e){}}).catch(function(e){})}}(s,r)}}async function p(){let e={active:!0,currentWindow:!0},n=await t().tabs.query(e);if(n&&n.length>0)return n[0];e={active:!0},n=await t().tabs.query(e);let s=await t().windows.getLastFocused({});for(let e in n)if(n[e].windowId===s.id)return n[e];return null}function d(){t().storage.local.get(["section_collapse_state"]).then(function(e){const n=e.section_collapse_state||{};document.querySelectorAll(".collapsible-title").forEach(e=>{const s=e.closest(".section-container"),r=s.getAttribute("data-section"),a=s.querySelector(".section-content");!0===n[r]?(e.classList.add("collapsed"),a.classList.add("collapsed")):e.classList.add("expanded"),e.addEventListener("click",function(s){s.stopPropagation(),e.classList.contains("collapsed")?(e.classList.remove("collapsed"),e.classList.add("expanded"),a.classList.remove("collapsed"),n[r]=!1):(e.classList.remove("expanded"),e.classList.add("collapsed"),a.classList.add("collapsed"),n[r]=!0),t().storage.local.set({section_collapse_state:n})})})})}async function u(e){const t=await async function(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){return!1}}(e);return!!t||(function(e){try{const t=document.createElement("textarea");t.value=e,t.style.cssText="\n            position: fixed;\n            left: -9999px;\n            top: -9999px;\n            width: 1px;\n            height: 1px;\n            opacity: 0;\n            z-index: -1;\n        ",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}catch(e){}}(e),!1)}function h(e,t,n=!1){const s=document.createElement("div");s.className="info-item";const r=document.createElement("div");if(r.className="tips",n&&(r.style.borderColor="#000000"),t){const e=document.createElement("a");e.href=t,e.title=t,e.appendChild(r),s.appendChild(e)}else s.appendChild(r);const a=document.createElement("span");return e&&"string"==typeof e&&e.includes("\n")?(a.innerHTML=e.replace(/\n/g,"<br>"),a.style.whiteSpace="pre-wrap",a.style.wordBreak="break-all"):a.textContent=e,/[a-zA-Z]\.p\+['"](.*?)\.js['"]/.test(e)&&(a.style.backgroundColor="#FFD700"),s.appendChild(a),[s]}function A(e){try{o.collapsedCount=0,o.totalElements=0;let n=0;for(var t in m)e[m[t]]&&(n+=e[m[t]].length);for(var t in e.showCode&&(n+=e.showCode.length),m)if(e[m[t]])try{let n=document.getElementById(m[t]);if(!n)continue;o.renderBatchToContainer(n,e[m[t]],(t,n)=>{try{return h(t,e.source[t],e.ai&&e.ai[t])}catch(e){return null}})}catch(e){continue}if(e.showCode&&e.showCode.length>0)try{let t=document.getElementById("showCode");t&&o.renderBatchToContainer(t,e.showCode,(t,n)=>{try{return x(t,e.source[t])}catch(e){return null}})}catch(e){}performance.now(),o.renderStartTime,i.logVirtualScrollStats()}catch(e){}}function f(e){!function(e,t){if(function(){const e=Date.now();return!s.isUpdating&&e-s.lastUpdateTime>=s.updateInterval}())r(),e(t),setTimeout(a,s.updateInterval);else if(s.pendingUpdate={function:e,data:t},!s.isUpdating){const e=s.updateInterval-(Date.now()-s.lastUpdateTime);setTimeout(()=>{s.pendingUpdate&&(r(),s.pendingUpdate.function(s.pendingUpdate.data),s.pendingUpdate=null,setTimeout(a,s.updateInterval))},e)}}(A,e)}function x(e,n){try{const s=document.createElement("div");s.className="showcode-item";const r=document.createElement("div");r.className="button-area";const a=document.createElement("div");a.className="tips";const i=document.createElement("a");i.href=n,i.title=n,i.appendChild(a),r.appendChild(i);const l=document.createElement("div");l.className="tips2";const c=document.createElement("a");c.href="#",c.title=t().i18n.getMessage("popupAIAnalysis"),c.appendChild(l),c.addEventListener("click",function(e){e.preventDefault();const r=s.querySelector(".code-content");if(r){const e=o.getCopyableTextFromSpan(r);p().then(function(s){t().runtime.sendMessage({greeting:"AIcode",current:s.url,code:e,from:n,tabid:s.id})})}}),r.appendChild(c),s.appendChild(r);const m=document.createElement("span");return m.className="code-content",m.textContent=e,/[a-zA-Z]\.p\+['"](.*?)\.js['"]/.test(e)&&(m.style.backgroundColor="#FFD700"),s.appendChild(m),[s]}catch(e){return null}}async function y(){const e=await async function(){try{return(await t().storage.local.get(["layout_config"])).layout_config||{leftColumn:[{id:"ip",name:"popupIp",priority:1},{id:"ip_port",name:"popupIpPort",priority:2},{id:"domain",name:"popupDomain",priority:3},{id:"mail",name:"popupMail",priority:4},{id:"mobile",name:"popupMobile",priority:5},{id:"sfz",name:"popupSfz",priority:6},{id:"jwt",name:"popupJwt",priority:7},{id:"algorithm",name:"popupAlgorithm",priority:8},{id:"secret",name:"popupSecret",priority:9}],rightColumn:[{id:"analyze",name:"popupAnalyze",priority:1},{id:"path",name:"popupPath",priority:2},{id:"incomplete_path",name:"popupIncompletePath",priority:3},{id:"url",name:"popupUrl",priority:4},{id:"static",name:"popupStaticPath",priority:5}]}}catch(e){return null}}();if(!e)return;const n=document.getElementById("left-column"),s=document.getElementById("right-column");n.innerHTML="",s.innerHTML="",e.leftColumn.forEach(e=>{const t=C(e);n.appendChild(t)}),e.rightColumn.forEach(e=>{const t=C(e);s.appendChild(t)}),d()}function C(e){const n=document.createElement("div");n.className="section-container",n.setAttribute("data-section",e.id);const s=document.createElement("div");s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-between";const r=document.createElement("div");r.className="findsomething_title collapsible-title",r.id=`popup${e.id.charAt(0).toUpperCase()+e.id.slice(1)}`,r.style.flex="1";const a=document.createElement("span");a.textContent=function(e){const n={ip:"popupIp",ip_port:"popupIpPort",domain:"popupDomain",sfz:"popupSfz",mobile:"popupMobile",mail:"popupMail",jwt:"popupJwt",algorithm:"popupAlgorithm",secret:"popupSecret",path:"popupPath",incomplete_path:"popupIncompletePath",url:"popupUrl",static:"popupStaticPath",analyze:"popupAnalyze"}[e];return n?t().i18n.getMessage(n):e}(e.id),r.appendChild(a);const o=document.createElement("div");if(o.className="section-content","analyze"===e.id){const e=document.createElement("div");e.id="showCode",e.textContent="🈚️",o.appendChild(e)}else{const t=document.createElement("p");t.id=e.id,t.textContent="🈚️","ip"!==e.id&&"domain"!==e.id&&"jwt"!==e.id||(t.style.wordBreak="break-word"),o.appendChild(t)}if(s.appendChild(r),"path"===e.id){const e=document.createElement("button");e.id="path_button",e.className="copy",e.name="path",e.textContent=t().i18n.getMessage("popupCopy"),s.appendChild(e);const n=document.createElement("button");n.id="popupCopyurl",n.className="copy",n.name="path",n.textContent=t().i18n.getMessage("popupCopyurl"),s.appendChild(n)}else if("analyze"!==e.id){const n=document.createElement("button");n.className="copy",n.name=e.id,n.textContent=t().i18n.getMessage("popupCopy"),s.appendChild(n)}return n.appendChild(s),n.appendChild(o),n}p().then(function(e){performance.now(),t().storage.local.get(["findsomething_result_"+e.url]).then(function(n){if(performance.now(),!n)return;if(!(n=n["findsomething_result_"+e.url]))return;performance.now();f(n),performance.now(),n.donetasklist?"done"!=n.done?document.getElementById("taskstatus").textContent=t().i18n.getMessage("popupProcessing")+n.donetasklist.length+"/"+n.tasklist.length:document.getElementById("taskstatus").textContent=t().i18n.getMessage("popupComplete")+n.donetasklist.length+"/"+n.tasklist.length:document.getElementById("taskstatus").textContent=t().i18n.getMessage("popupProcessing")}).catch(function(e){performance.now()})}),t().storage.onChanged.addListener(function(e,n){p().then(function(n){for(let[s,{oldValue:r,newValue:a}]of Object.entries(e))if(s=="findsomething_result_"+n.url){const e=a;performance.now(),f(e),e.donetasklist?"done"!=e.done?document.getElementById("taskstatus").textContent=t().i18n.getMessage("popupProcessing")+e.donetasklist.length+"/"+e.tasklist.length:document.getElementById("taskstatus").textContent=t().i18n.getMessage("popupComplete")+e.donetasklist.length+"/"+e.tasklist.length:document.getElementById("taskstatus").textContent=t().i18n.getMessage("popupProcessing")}})}),t().runtime.onMessage.addListener((e,t,n)=>{"showCode"===e.greeting&&function(e,t){try{let n=document.getElementById("showCode");if(!n)return;o.renderBatchToContainer(n,[e],(e,n)=>{try{return x(e,t)}catch(e){return null}})}catch(e){}}(e.message,e.source)}),d(),y().then(()=>{g()});const b=document.getElementById("vip-button"),v=createEzrevenueService();async function w(){t().storage.local.get(["vipSwitch"]).then(function(e){if(!0===e.vipSwitch)v.isBalanceUsable().then(e=>{if(b.innerText=e?t().i18n.getMessage("popupVipMember"):t().i18n.getMessage("popupVipSubscribe"),!e){const e=document.getElementById("showCode");e&&(e.textContent=t().i18n.getMessage("popupVipFeature"))}});else{b.innerText=t().i18n.getMessage("popupVipSubscribe");const e=document.getElementById("showCode");e&&(e.textContent=t().i18n.getMessage("popupVipFeature"))}})}function E(e,t="info",n=3e3){const s=document.getElementById("popup-toast");s&&s.remove();const r=document.createElement("div");r.id="popup-toast",r.className="popup-toast",r.style.background="error"===t?"#f44336":"success"===t?"#4caf50":"#2196f3",r.textContent=e;const a=document.getElementById("popup-toast-container");a&&(a.appendChild(r),setTimeout(()=>{r.style.opacity="1",r.style.transform="translateX(0)"},100),setTimeout(()=>{r.style.opacity="0",r.style.transform="translateX(-100%)",setTimeout(()=>{r.parentNode&&r.remove()},300)},n))}b.addEventListener("click",async()=>{t().storage.local.get(["vipSwitch"]).then(function(e){!0===e.vipSwitch?v.showPaywallPopup().then(()=>{w()}):v.showPaywallPopup(),t().runtime.sendMessage({greeting:"refreshVipStatus"}).then(function(e){}).catch(function(e){})})}),document.addEventListener("DOMContentLoaded",async()=>{await w()}),t().storage.onChanged.addListener(function(e,t){for(let[t,{oldValue:n,newValue:s}]of Object.entries(e))"vipSwitch"==t&&w(),"layout_config"==t&&y().then(()=>{g()})}),t().runtime.onMessage.addListener((e,t,n)=>{"aiStatus"===e.greeting&&E(e.message,e.type||"info")})})()})();